<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://kit.fontawesome.com/efd33a6a78.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
            <!--List student-->
        <div id="list-item" class="list-item">
            <!--Javascript add listt-items here-->
        </div>

        <!--Right container with form-->
    <div class="right-container">
        <form action="#" id="main-form" >
            <div class="main-form__input">
                <label for="name">Name</label>
                <input type="text" name="name" placeholder="Enter your name" id="name" required/>
            </div>

            <div class="main-form__input">
                <label for="name">Address</label>
                <input type="text" name="address" placeholder="Enter your address" id="address" required/>
            </div>

            
            <div class="main-form__input">
                <label for="">Phone</label>
                <input type="number" placeholder="Enter your Phone" id="phone" required>
            </div>

            <div class="main-form__input">
                <label for="">Email</label>
                <input type="email" placeholder="Enter your Email" id="email" required>
            </div>

            <div class="main-form__input">
                <label for="">Age</label>
                <input type="number" min="18" max="90" placeholder="Enter your age" id="age" required>
            </div>

            <div class="main-form__input">
                <label for="">Which option is your current job?</label>
                <select id="selectOption" required>
                    <option value="" disabled selected>Select current job</option>
                    <option value="1">Student</option>
                    <option value="2">Software developer</option>
                    <option value="3">Web-fullstack developer</option>
                    <option value="4">Software engineer</option>
                </select>
            </div>

            
                <button type="submit" id="submit" class="submit-button">
                  Submit
                </button>
        </form>
    </div>

</div>

<!--Popup edit section-->
<div id="popup-section" class="edit__popup">
    <i id="popup-close" class="popup-close fas fa-times-circle"></i>
    <form action="#" id="popup__form" >
        <div class="popup__form--input">
            <label for="name">Name</label>
            <input type="text" name="name2" placeholder="Enter your name" id="name2" required/>
        </div>

        <div class="popup__form--input">
            <label for="name">Address</label>
            <input type="text" name="address2" placeholder="Enter your address" id="address2" required/>
        </div>

        
        <div class="popup__form--input">
            <label for="">Phone</label>
            <input type="number2" placeholder="Enter your Phone" id="phone2" required>
        </div>

        <div class="popup__form--input">
            <label for="">Email</label>
            <input type="email" placeholder="Enter your Email" id="email2" required>
        </div>

        <div class="popup__form--input">
            <label for="">Age</label>
            <input type="number" min="18" max="90" placeholder="Enter your age" id="age2" required>
        </div>

        <div class="popup__form--input">
            <label for="">Which option is your current job?</label>
            <select id="selectOption2" required>
                <option value="" disabled selected>Select current job</option>
                <option value="1">Student</option>
                <option value="2">Software developer</option>
                <option value="3">Web-fullstack developer</option>
                <option value="4">Software engineer</option>
            </select>
        </div>

        <button type="submit" id="submit2" class="submit-button2">
            Submit
          </button>
    </form>
  
    
</div>


<div id="student__popup" class="student__popup--hide">
    <h2>Student name</h2>
    <div class="student__infomation">
        <div>info</div>
        <div>credit</div>
        <div>portfolio</div>
    </div>
    <div class="student__text">
        <ul class="student__text--info">
            <li>Our passion is to build great customer experiences</li>
            <li>You have proven skills in Front End development</li>
            <li>We highly value experience with</li>
            <li>Front End Developer, Ålands Penningautomatförening (PAF), Maarianhamina
            </li>
            <li>Työtehtäviisi kuuluu sekä uuden sisällön tuottaminen että jo olemassa olevan sisällön </li>
            <li>Ideaalihakijamme on tekniseen viestintään erikoistunut tai muuten teknisellä taustalla varustettu henkilö</li>
            <li>jolla on jo hieman kokemusta teknisellä alalla työskentelystä</li>
            <li>Ideaalihakijamme on tekniseen viestintään erikoistunut tai muuten teknisellä taustalla varustettu henkilö</li>
           
        </ul>
    </div>
    <div class="small-gallery">
        <div class="img-box">
            <div class="img-content box1"></div>
        </div>
        <div class="img-box">
            <div class="img-content box2"></div>
        </div>
        <div class="img-box">
            <div class="img-content box3"></div>
        </div>
        <div class="img-box">
            <div class="img-content box4"></div>
        </div>
        <div class="img-box">
            <div class="img-content box5"></div>
        </div>
        <div class="img-box">
            <div class="img-content box6"></div>
        </div>
        <div class="img-box">
            <div class="img-content box7"></div>
        </div>
        <div class="img-box">
            <div class="img-content box8"></div>
        </div>
    </div>
    <div class="student__gallery">
        
    </div>
</div>



<!--Javascript part*********************************************-->
<script>
    'use strict';

    window.onload = checkExitsLocalStorage();
    
//check if localStorage not exits, then create new localStorage
    function checkExitsLocalStorage() {
        var ifExits = localStorage.length; //return 0 if not exits
        if(ifExits < 1){
            const jsonData = JSON.stringify([{"name":"example","address":"none","phone":"00056844","email":"example@gmail.com","age":"12","job":"none"}]);
            localStorage.setItem("STUDENT_DATA", jsonData);
        }
    }
    //create object to store student info, function
    var storeKey = "STUDENT_DATA";
    let listItem = document.getElementById("list-item");
    const Student = {
        
        data : [],

        
        load: function() {
            const jsonData = localStorage.getItem(storeKey);
            try {
                    this.data = JSON.parse(jsonData);
            } catch (e) {
                alert("chua co thong tin");
            }
        },

        add: function(student){
            this.data.push(student)
        },

        edit:function(index, student){
            this.data[index] = student;
        },

        delete: function(index){
            this.data.splice(index,1);
        },

        
        save: function(){
                const jsonData = JSON.stringify(this.data);
                localStorage.setItem(storeKey, jsonData);
        },


        get list(){
            return this.data;
        }

    }

      Student.load();
      renderStudents();
    

      //[{"name":"","address":"","phone":"","email":"","age":"","job":""}]
    

    //when submit button click
    document.getElementById("submit").addEventListener("click",submitClickHandle);
    function submitClickHandle() {
        
        var name = getInputValue("#name");
        var address = getInputValue("#address");
        var phone = getInputValue("#phone");
        var email = getInputValue("#email");
        var age = getInputValue("#age");
        var selected = changeSelectedValue(getInputValue("#selectOption"));
        
        Student.add({
            name: name,
            address: address,
            phone: phone,
            email: email,
            age: age,
            job: selected
            });

        Student.save();
        window.location.reload();
    }

   
    //render student item to html items list
    
    function renderStudents() {

        const Students = Student.list;

        for(let i = 0; i < Students.length; i++){

            //console.log(Students.length);
            var opiskelija = Students[i];
            var itembox = document.createElement("div");
            itembox.setAttribute("class", "item__box");
            let divItem = document.createElement("div");
            let divIcon = document.createElement("div");
            let divCopiedStudent = document.createElement("div");

            divItem.setAttribute("class", "item__box--info");
            divIcon.setAttribute("class", "item__box--icon");

            let studentCopyInfo = opiskelija.name + ", " + opiskelija.address + ", " + opiskelija.phone + ", " + opiskelija.email + ", " + opiskelija.age + ", " + opiskelija.job;

            divItem.innerHTML = '<p>Name: '+ opiskelija.name +'</p><p>Address : '+ opiskelija.address +'</p><p>Phone : '+ opiskelija.phone +'</p><p>Email: '+ opiskelija.email +'</p><p>Age: '+ opiskelija.age +'</p><p>Job : '+ opiskelija.job +'</p>';
            divCopiedStudent.innerHTML = '<input class="myInput" type="text" value="'+studentCopyInfo+'" id="myInput'+ i +'"><div id="copiedStudent'+ i +'" class="copyStudent">Copy Student</div>';
            divIcon.innerHTML = '<i id="delete" class="fas fa-trash-alt" onclick="onDeleteStudent(' + i + ')"></i><i id="edit" class="fas fa-edit" onclick="onEditStudent(' + i + ')"></i><i id="copy" class="fab fa-creative-commons-share" onclick="onCopyStudentInfo(' + i + ')"></i><i id="info" class="fas fa-info-circle" onclick="onGetInfoStudent(' + i + ')"></i>';
            

            itembox.appendChild(divItem);
            itembox.appendChild(divCopiedStudent);
            itembox.appendChild(divIcon);
           // console.log(opiskelija.job);
            listItem.appendChild(itembox);
            
        }

        
    }

    /*
    <div class="item__box">
        <div class="item__box--info">
            <p>Name: </p>
            <p>Address : </p>
            <p>Phone : </p>
            <p>Email: </p>
            <p>Age: </p>
            <p>Job : Student</p>
        </div>
        <div class="copiedStudent">Copy Student</div>
        <div class="item__box--icon">
            <i id="delete" class="fas fa-trash-alt" onclick="onDeleteStudent(i)" aria-hidden="true"></i>
            <i id="edit" class="fas fa-edit" onclick="onEditStudent(i)" aria-hidden="true"></i>
            <i id="copy" class="fab fa-creative-commons-share" onclick="onCopyStudentInfo(i)" aria-hidden="true"></i>
            <i id="info" class="fas fa-info-circle" onclick="onGetInfoStudent(i)" aria-hidden="true"></i>
        </div>
    </div>
    */


//delete item
    function onDeleteStudent(index) {

        let CheckAnswer = confirm("Delete this student ?");
        if(CheckAnswer){
            Student.delete(index);
            Student.save();
            window.location.reload();
        }
    }

                
            
//edit item
    function onEditStudent(index) {
            document.getElementById("popup-section").removeAttribute("class");
            document.getElementById("popup-section").setAttribute("class", "edit__popup--open");
            document.getElementById("submit2").addEventListener("click", submitForm);
           
            document.getElementById("name2").value = Student.data[index].name;
            document.getElementById("address2").value = Student.data[index].address;
            document.getElementById("phone2").value = Student.data[index].phone;
            document.getElementById("email2").value = Student.data[index].email;
            document.getElementById("age2").value = Student.data[index].age;

            var selectedValue = Student.data[index].job;
            console.log(selectedValue);
            switch(selectedValue){
                case "Student":
                document.getElementById("selectOption2").value = "1";
                break;
                case "Software Developer":
                document.getElementById("selectOption2").value = "2";
                break;
                case "Web -fullstack developer":
                document.getElementById("selectOption2").value = "3";
                break;
                case "Sofware engineer":
                document.getElementById("selectOption2").value = "4";
                break;
            
            }

            document.getElementById("submit").removeEventListener("click",submitClickHandle);
            document.getElementById("submit").addEventListener("click", function(event){
            event.preventDefault()
});
            

            
            
            function submitForm(){
                

                var name2 = getInputValue("#name2");
                var address2 = getInputValue("#address2");
                var phone2 = getInputValue("#phone2");
                var email2 = getInputValue("#email2");
                var age2 = getInputValue("#age2");
                var selected2 = changeSelectedValue(getInputValue("#selectOption2"));
            
                var convertStudentToString = '{"name":"'+name2+'","address":"'+address2+'","phone":"'+phone2+'","email":"'+email2+'","age":"'+age2+'","job":"'+selected2+'"}';
                var editedStudent = JSON.parse(convertStudentToString); //convert String to JSON
                Student.edit(index, editedStudent);  
                Student.save();
                window.location.reload();
            }      
    }


    
    // copy student info
    

    function onCopyStudentInfo(info){
        

        var copyText = document.getElementById("myInput" + info);
        copyText.removeAttribute("class");
        copyText.setAttribute("class", "myInput2");
        copyText.select();
        copyText.setSelectionRange(0, 99999)
        document.execCommand("copy");
        /* Copy the text inside the text field */

        let studentInfo = document.getElementById("copiedStudent" + info);
        console.log(studentInfo);
        studentInfo.removeAttribute("class");
        studentInfo.setAttribute("class", "copiedStudent");
        setTimeout(function(){
            studentInfo.removeAttribute("class");
            studentInfo.setAttribute("class", "copyStudent");
            copyText.removeAttribute("class");
            copyText.setAttribute("class", "myInput");
        }, 600);
    }

    

    //popup click

    document.getElementById("popup-close").addEventListener("click", closeBtn);

    function closeBtn(){
        document.getElementById("popup-section").removeAttribute("class");
        document.getElementById("popup-section").setAttribute("class", "edit__popup");
        window.location.reload();
    }




    //info--popup--student


//******************************************DANG LAM TOI DAY********************************************
    //*******************************************************************************************************

    
    function onGetInfoStudent(info){
        let popup = document.getElementById("student__popup");
        popup.removeAttribute("class");
        popup.setAttribute("class", "student__popup");
    }


    
    function changeSelectedValue(getValue) {
        switch(getValue){
            case "1":
            return "Student";
            break;

            case "2":
            return "Software Developer";
            break;

            case "3":
            return "Web -fullstack developer";
            break;

            case "4":
            return "Sofware engineer";
            break;

            default:
            return "Not selected";
            break;
        }
    }

    function getInputValue(selector){
        var inputValue = document.querySelector(selector);
        return inputValue.value;
    }


    
    

    

</script>
</body>
</html>